## 二、概要设计文档
### 1. 系统总体架构
- **表示层**：`Maingame` 窗口、`Loadprocess` 启动画面、`EndPanel` 结算窗口、`CardPanel`/`MyButtonGroup`/`Timecount` UI 控件。
- **业务控制层**：`gamecontrol` 负责全局状态机（发牌/抢地主/出牌）、信号槽、计分与流程推进。
- **领域层**：`player` 及其子类 `user`、`robot`；`Card`/`Cards` 表示牌值集合；`PlayHand` 判型；`Strategy`/`robotgetloard`/`robotplayhand` 实现 AI 决策。
- **资源与音效层**：`Bgmcontrol` 管理背景音乐/音效；`res.qrc` 管理图片、音频与 JSON 配置。

### 2. 模块划分与关系
- `Maingame` 持有 `gamecontrol` 实例，订阅其信号（状态变更、出牌、叫分、倒计时、结算）。
- `gamecontrol` 维护三名 `player` 对象，分发牌堆、调用玩家接口触发 AI/用户操作，并通过信号与 UI 通信。
- `player`/`robot`/`user` 通过信号 `notifygrablordbet`、`notifyplayhand` 将操作回传给 `gamecontrol`。
- `Strategy` 读取 `Cards`/`PlayHand` 信息计算最优出牌或是否压制。
- 资源文件与界面布局通过 Qt Designer 生成的 `.ui` 与 `res.qrc` 绑定。

### 3. 主要流程
- **启动**：`main.cpp` 创建 `QApplication`，显示 `Loadprocess`；加载完毕后进入 `Maingame`。
- **发牌**：`gamecontrol::SetAllCards` 初始化牌堆；`Maingame::SatrtPend` 调度 `PendCardplayer` 动画发牌至三名玩家。
- **抢地主**：`gamecontrol::StartPrepareLord` -> 玩家 `PrepareGetLord` -> `Onbet` 统计叫分；三轮结束后 `BecomeLord` 发放底牌并切换到出牌状态。
- **出牌**：`gamecontrol::GamePlayhand` 校验“要不起”与正常出牌，更新 `_PlayHandplayer/_PlayHandCards`，通知 UI 与下家；`Maingame::OndisPosePlayhand` 渲染出牌区与音效。
- **结算**：当某玩家手牌为空，按倍数结算分数，发射 `S_PlayResult` 与 `USERWIN` 状态，`EndPanel` 展示结果。
- **重新开局**：`Maingame::RePlayGame` -> `gamecontrol::RetCardDate` 重置牌堆、玩家状态、UI 选中状态，重新发牌。

### 4. 界面结构
- 主窗口 1000x650：背景图、三方出牌区、手牌区、头像/身份标签、提示标签、按钮组（抢地主、出牌、不要、重新开始）、倒计时、分数面板。
- 启动画面：进度条式加载条与背景图。
- 结算面板：显示胜负、分数、继续游戏按钮。

### 5. 关键数据结构
- `Card`：点数 `cardpoint`、花色 `cardsuit`；比较/哈希重载支持 `QSet` 存储。
- `Cards`：`QSet<Card*>` 存储手牌集合，支持增删、排序、随机抽取、点数统计。
- `_Playercontext`（Maingame 内部）：记录每个玩家的手牌区域、出牌区域、头像/提示标签位置及最后出牌缓存。
- `Betrest`：跟踪抢地主轮次与最高叫分。
