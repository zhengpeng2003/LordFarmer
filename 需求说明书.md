# 需求说明书

## 1. 系统背景
项目是基于 Qt Widgets 的本地桌面端“欢乐斗地主”游戏，提供 1 名用户与 2 名机器人对战的单机局。流程涵盖加载界面、发牌、抢地主、出牌、计分、结算与重新开局，并配有动画和音效资源。

## 2. 系统目标
- 支持完整的一局斗地主，包括发牌、抢/叫地主、出牌、结算与重新开始。
- 提供直观的图形界面，包含卡牌展示、头像、提示标签、倒计时与动画。
- 提供机器人 AI 决策，能够自动叫分、出牌并与用户对战。
- 提供音效与背景音乐，强化操作反馈与节奏。

## 3. 角色与受众
- **玩家（user）**：真人用户，通过界面按钮与卡牌交互进行抢地主、出牌或要不起。
- **机器人（robot）**：左右两名 AI 玩家，自动决策叫分与出牌逻辑。
- **游戏控制器（gamecontrol）**：调度全局状态、牌堆、流程与信号，是 UI 与玩家对象之间的协调者。

## 4. 功能需求
1. **加载与进入游戏**：启动后显示加载动画与背景图，完成后进入主界面。
2. **发牌与抢地主**：
   - 初始化 54 张牌堆并轮流发牌给三名玩家，剩余三张作地主牌。
   - 轮询三位玩家叫分/抢地主，若均不叫则重新洗牌发牌；若有人叫分则发放底牌并确定地主。
3. **出牌流程**：
   - 地主先出牌，轮换到其他玩家；支持“要不起”并保留上一手有效出牌者。
   - 机器人基于策略评估出牌组合；用户可拖拽/点击选择卡牌，校验牌型与能否压制上家。
4. **计分与倍数**：
   - 记录叫分倍数与炸弹翻倍；按地主/农民身份结算分数与胜负。
5. **界面呈现**：
   - 显示牌面、头像、身份标签、出牌区与“不要”提示；提供发牌、出牌、炸弹、飞机等动画及音效。
   - 倒计时提醒用户操作，超时自动出牌或判定要不起。
6. **重新开局**：结算后可重新开始，重置牌堆、玩家状态、分数与界面卡牌。

## 5. 非功能需求
- **性能**：界面交互、动画与音效需保持流畅，发牌/计时依赖 `QTimer`。
- **可靠性**：重新开局必须清理上一局状态，避免空指针和残留牌面。
- **可用性**：固定窗口大小 1000x650，提供直观按钮和音效提示。
- **兼容性**：支持 Windows/Linux/macOS 的 Qt 桌面环境。

## 6. 约束条件
- 使用 Qt Widgets 框架与 Qt 资源系统，依赖多媒体播放与动画组件。
- 无网络联机与数据库存储，所有数据停留在内存结构中。
- 资源路径通过 `res.qrc` 管理，需保持相对路径一致。

## 7. 运行环境
- Qt 5 或 Qt 6，启用 Widgets、Multimedia、Core 等模块。
- C++17 编译器（MSVC、MinGW、GCC 或 Clang）。
- 桌面操作系统：Windows / Linux / macOS。

## 8. 用户需求
- 进入游戏后看到加载动画与随机背景图，开始按钮发起一局。
- 能够选择抢/不抢地主，看到叫分/抢地主提示及音效。
- 能够选择卡牌出牌或点击“不要”，若无法压制上家则给出反馈。
- 界面展示每名玩家手牌数量、出牌区和“要不起”提示，结算后展示胜负与分数。
- 可通过按钮重新开始新一局，重置状态并重新发牌。
